# -------------------------
# Bot / User-Agent blocking
# -------------------------
# Mark bad bots
SetEnvIfNoCase User-Agent "libwww-perl" bad_bot
SetEnvIfNoCase User-Agent "curl" bad_bot
SetEnvIfNoCase User-Agent "wget" bad_bot
SetEnvIfNoCase User-Agent "python" bad_bot
SetEnvIfNoCase User-Agent "Go-http-client" bad_bot
SetEnvIfNoCase User-Agent "scrapy" bad_bot
SetEnvIfNoCase User-Agent "^$" bad_bot

# Mark good search bots
SetEnvIfNoCase User-Agent "googlebot" good_bot
SetEnvIfNoCase User-Agent "bingbot" good_bot
SetEnvIfNoCase User-Agent "yandex" good_bot
SetEnvIfNoCase User-Agent "duckduckbot" good_bot

# Apache 2.2 style
<IfModule !mod_authz_core.c>
  Order Allow,Deny
  Allow from env=good_bot
  Allow from all
  Deny from env=bad_bot
</IfModule>

# Apache 2.4+ style (recommended on modern servers)
<IfModule mod_authz_core.c>
  <RequireAll>
    Require env good_bot
    Require all granted
  </RequireAll>
  <If "%{ENV:bad_bot} == '1'">
    Require all denied
  </If>
</IfModule>

# ==========================
# RATE LIMIT (mod_ratelimit)
# ==========================
<IfModule mod_ratelimit.c>
  # Rate limit responses (test value first; units depend on server config)
  SetEnvIf Request_URI ".*" rate_limit
  SetOutputFilter RATE_LIMIT
  # try with 400 (adjust if needed)
  SetEnv rate-limit 400
</IfModule>
<IfModule mod_authz_core.c>
  <FilesMatch "^(index\.php)$">
    Require all granted
  </FilesMatch>
</IfModule>
<IfModule !mod_authz_core.c>
  <FilesMatch "^(index\.php)$">
    Order allow,deny
    Allow from all
  </FilesMatch>
</IfModule>

Options -Indexes
